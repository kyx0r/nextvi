NEXTVI PATCHES
==============
Optional patches for Nextvi.
Apply: patch < name.patch

arrowkeys_normal.patch
--------------
Adds arrows keys support in normal mode.

arrowkeys_insert.patch
--------------
Adds arrows keys support in insert mode.

longbuf.patch
--------------
Overcome 2GB buffer size limitations. Fix all warns Will be able to read very
large files.

threaded_search.patch
--------------
Multithreaded version of lbuf_search(). Adjust the number of threads in use
and buffer stepping in lbuf.c Ensure that your system supports posix threads,
aka libpthread

colors_lnum.patch
--------------
Demonstrates the most simple way one could go about customizing colors for
linenumbers triggered by # keybind without breaking existing syntax
highlights on the c filetype. More complicated approach can be to use
syn_addhl() and a NULL pattern, however that requires more modifications.

hl_part.patch
--------------
Allow syntax highlight to continue past the terminal dimensions up to a
certain limit. To customize the depth, adjust LEDFORW and LEDBACK definitions
in led.c

hl_naive.patch
--------------
Original approach to syntax highlight as in neatvi.
Pros:
1. simpler and shorter code in led_render()
2. unlimited length, can highlight anything pikevm is willing to match.
3. retains correct right to left highlight if option order=0 and td=-2 are set.
Base nextvi will always highlight left to right, unless the line does not
extend past the terminal.
4. Requires a bit less amount of memory to run.
Cons:
1. Terrible performance, need to disable syntax hl if working with lines 10K+
(You've been warned!)
2. Cannot render lines like those by option pac=1 efficiently. Will recompute
the whole string every iteration.
3. Difficult to adapt other kinds of codes to make use of.
Note: Patch is not compatible with hl_part.patch in any way, pick one or the
other.

debug.patch
--------------
Cleanup reachable memory upon termination.
Use for debugging.
Note: in some features leaks won't be freed - for example hlw (which is not
enabled by default) Also initializes sdense in regex.c so that valgrind stops
freaking out.

grep.patch
--------------
Adds a special temporary buffer /grep/ much like the default /hist/ or /fm/.
When new keybind ^x is executed vi performs fs_search on every file and
stores the results in /grep/ buffer. At last, user will be switched to /grep/.
Line information is stored and displayed with special new syntax highlight
rules. Searched keyword is also highlighted.  Use the familiar keybind ^i or
TAB on the wanted line to immediately open the file and goto the line
specified.  Upon next use of ^x keybind, old results get discarded. To re-
open /grep/ without discarding use new keybind vx The format of the lines
stored is specifically designed to mirror the output of grep -r -n "str" .
so that the feature can be substituted with a pipe command in case of a
higher performing grep implementation or loading of cached results from script.

rstr.patch
--------------
Adaptation from upstream neatvi, where simple operations are optimized by
running a specialized search code instead of full regex engine. rstr can
yeild up to 3X faster search on non regex patterns. This is not included in
base nextvi due to underlying complexity.

stdin_pipe.patch
--------------
Allows the user to use vi like less except you need to specify
- as command line arg (just like in vim).
Example:
$ dmesg | vi -

ec_closebuf.patch
--------------
Allows the user to close the buffer using new ex command :cx
Specify a number as an arg for what buffer to close.
Specifying no argument(s) will close the current buffer.
When the buffer is closed all buffers above will be shifted
and renumbered.
Range can be supplied like so :cx0-5
This will close buffers 0 to 5 inclusive
Omiting the parameter of the range assumes current buffer
index for that parameter (not inclusive and either begin or end
of the range). Example :cx-5 or :cx5-

filetype_shebang.patch
--------------
Detect and set the corresponding filetype based on the shebang
or specific data in the file. Currently supports only shell
and python.

star_search.patch
--------------
Alternative to ^a search but does not center the screen.

kbd_layout.patch
--------------
Changes hjkl to work well with other keyboard layouts.
In this example hjkl is changed to yneo (workman keyboard layout)
Note: this patch can be used as a base for remapping any base keybinds.

quickexit.patch
--------------
Added quickexit to insert mode keybind: kj
It's important to understand that this has a caveat, if input comes too fast,
for example a paste from terminal and the sequence has "kj" in it, insert
mode will be cancelled mid way and paste will be wrong. Luckily this almost
never happens because such letter combination is extremely rare.
Delay time (in ms) can be set via :se qe=N or disabled by setting N to 0.

hl_mark.patch
-------------
Adds new ex option "mhl" which will highlight lbuf marks. Each mark has
different color up to 16. Higher marks may duplicate the colors.

c_option.patch
-------------
Adds -c commandline option. This can be used to pass in ex commands instead
of EXINIT.

exrc.patch
-------------
Adds support for reading ~/.exrc file. This can be used to pass in ex
commands instead of EXINIT.

readonly.patch
-------------
Adds new ex option "ro" and commandline readonly option -R

Helper macros:
--------------
@q = creates structure like this:
{

}
@w = creates structure like this:
whatever {
	whatever
	a
}
@e = creates ()
@r = creates ""
@a = creates a comment like this:
/* whatever */
@s = from the cursor creates a comment like this:
/* whatever */
@d = uncomment /* */ comment
@x = indent % region left
@f = bring !cp % %_|w|!diff %_ % macro into ex prompt.
Use to create patch and diff files fast. It relies on
you not saving the file prior to running the macro.
@c = run ac command and reindex ac db

export EXINIT="se noled|tp Oo{
}kA
	|tp 1G2\"qY2j\"Qy$|tp oA {jo}koa|tp 0\"wy$|tp oa()i|tp 0\"ey$|tp oa\"\"i|tp 0\"ry$|tp oI/*A*/|tp 0\"aY|tp oi/*A*/|tp 0\"sy$|tp o/\/\*
2x/\*\/
2x|tp 02k2\"dY2j\"Dy$|tp o>\%<<\$\%<<|tp 0\"xy$|tp o:\!cp \% \%_\\|w\\|\!git diff --no-index \%_ \%|tp 0\"fy$|tp o:ac  \\|tp i\\|u\\|ac3ls|tp 0\"cy$|inc (^[\!.git]+[^\\/]+$)|tp 50u|se led"

remove_compound_literals.patch
--------------
Removes compound literals for portability reasons.

remove_variable_length_arrays.patch
--------------
Removes variable length arrays for portability reasons.
