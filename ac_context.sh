#!/bin/sh
# Generated by patch2vi from unified diff
# Separator: '@'
set -e

# Path to nextvi (adjust as needed)
VI=${VI:-vi}

# Verify that VI is nextvi
if ! $VI -? 2>&1 | grep -q 'Nextvi'; then
    echo "Error: $VI is not nextvi" >&2
    echo "Set VI environment variable to point to nextvi" >&2
    exit 1
fi

# Patch: led.c
EXINIT="rcm:|sc! @|vis 6@551,552c 				is->lsug = is->sug_pt >= 0 ? is->sug_pt : led_lastword(sb->s);
				if (suggestsb && search(sb, is->lsug, pre)) {
.
@vis 4@vis 6@537;16;46c , is->lsug, pre
.
@vis 4@vis 6@531,532c 				for (i = 0; is->sug[i] && sb->s[i+is->lsug] == is->sug[i]; i++){}
				sbuf_cut(sb, MAX(is->lsug+i, pre))
				sbuf_str(sb, is->sug+i)
.
@vis 4@vis 6@520;63;76c )
.
@vis 4@vis 6@412a 	if (ai_max >= 0 && xpac) {
		c = 0;
		goto pac;
	}
.
@vis 4@vis 6@32c 		part = strstr(part+len, sb->s+l);
	}
	if (l < pre && sb->s[pre]) {
		l = pre;
		goto again;
.
@vis 4@vis 6@29;7;7c  if (l >= pre)
.
@vis 4@vis 6@26;15;15c sb->s_n - 
.
@vis 4@vis 6@20c 	again:;
	char *part = strstr(acsb->s, sb->s+l);
.
@vis 4@vis 6@16c 	if (!sb->s[l])
.
@vis 4@vis 6@14c static int search(sbuf *sb, int l, int pre)
.
@vis 4@wq" $VI -e 'led.c'
