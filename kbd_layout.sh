#!/bin/sh
# Generated by patch2vi from unified diff
# Separator: '@'
set -e

# Path to nextvi (adjust as needed)
VI=${VI:-vi}

# Verify that VI is nextvi
if ! $VI -? 2>&1 | grep -q 'Nextvi'; then
    echo "Error: $VI is not nextvi" >&2
    echo "Set VI environment variable to point to nextvi" >&2
    exit 1
fi

# Patch: kmap.h
EXINIT="rcm:|sc! \\\\@|vis 6@%;f> static char \\\\*kmap_en\\\\[256\\\\] = \\\\{
	\\\\[0\\\\] = \"en\",@??!.-5,.+5p\@p FAIL line 2\@q!@;=
@.+1a 	['y'] = \"h\",
	['n'] = \"j\",
	['e'] = \"k\",
	['o'] = \"l\",
	['h'] = \"y\",
	['j'] = \"n\",
	['k'] = \"e\",
	['l'] = \"o\",
.
@vis 4@wq" $VI -e 'kmap.h'

# Patch: term.c
EXINIT="rcm:|sc! \\\\@|vis 6@%;f> 			err:
			\\\\*ibuf = 0;
		\\\\}@??!.-5,.+5p\@p FAIL line 175\@q!@;=
@.+2a 		if (*ibuf > 0 && conf_kmap(0)[*ibuf])
			*ibuf = *conf_kmap(0)[*ibuf];
.
@vis 4@wq" $VI -e 'term.c'
